# BLE Penetration Testing Configuration - Full Example
# 
# This is a comprehensive example configuration file that demonstrates all available options.
# For a minimal example, see config_minimal.yaml
# For a safety-focused example, see config_safety_first.yaml
#
# Usage: python -m ble_pentest scan --config config_example.yaml

# Global settings affecting all operations
global:
  # Enable detailed output to console (true/false)
  # Verbose mode provides packet-level information and detailed diagnostic output
  verbose: false
  
  # Timeout for initial device discovery in seconds
  # Longer timeouts will discover more devices but take more time
  discovery_timeout: 10
  
  # Maximum number of devices to track simultaneously
  # Useful for limiting memory usage in environments with many BLE devices
  max_devices: 100
  
  # Optional log file path for audit trail
  # If null or omitted, only console output is generated
  # Logs include all operations, timestamps, and results
  log_file: null
  
  # Enable debug mode for development and troubleshooting (true/false)
  debug: false

# Target device specifications
# At least one of address or name_pattern should be specified
target:
  # Specific device MAC address to test (e.g., "AA:BB:CC:DD:EE:FF")
  # If specified, all other target filters are ignored
  # Use this for testing a specific known device
  address: null
  
  # Device name pattern using wildcards (* and ?)
  # * matches any number of characters
  # ? matches exactly one character
  # Examples: "TestDevice*", "Fitbit-???", "*Heart*"
  # If specified, only devices matching the pattern will be tested
  name_pattern: null
  
  # Target a specific BLE service by UUID
  # Examples:
  #   "180D" - Heart Rate Service
  #   "180A" - Device Information Service
  #   "1805" - Current Time Service
  # If specified, only devices advertising this service will be targeted
  service_uuid: null
  
  # List of characteristic UUIDs to interact with during testing
  # Examples:
  #   - "2A37" - Heart Rate Measurement
  #   - "2A18" - Body Sensor Location
  #   - "2A19" - Heart Rate Control Point
  # Used primarily for fuzzing and data interaction tests
  characteristics: []

# Attack-specific parameters
attack:
  # Type of attack to perform
  # Options:
  #   "scan" - Device discovery and enumeration
  #   "pairing" - Analyze pairing mechanisms
  #   "mitm" - Detect man-in-the-middle attack feasibility
  #   "fuzzing" - Protocol robustness testing
  #   "replay" - Replay attack detection
  type: "scan"
  
  # Maximum time for attack execution in seconds
  # Different attack types may use this value differently
  # Scan: total discovery time
  # Pairing: total pairing attempt time
  # Fuzzing: total fuzzing duration
  # MITM: monitoring window duration
  timeout: 30
  
  # Automatically retry on failure (true/false)
  retry_on_failure: true
  
  # Maximum number of retry attempts if retry_on_failure is enabled
  # Typical values: 1-5 attempts
  max_retries: 3
  
  # Delay between retry attempts in seconds
  # Gives devices time to recover between attempts
  retry_delay: 2
  
  # Attack intensity (for fuzzing and similar tests)
  # Values: "low", "medium", "high"
  # Higher intensity = more payloads but higher risk of device disruption
  intensity: "medium"

# Report generation settings
reporting:
  # Output format for reports
  # Options:
  #   "json" - Machine-readable JSON format
  #   "html" - Human-readable HTML with styling
  #   "pdf" - Formatted PDF document
  # HTML and PDF require additional dependencies
  format: "json"
  
  # Include detailed packet captures in report (true/false)
  # Note: Packet captures significantly increase report size
  # Disable for sensitive environments or when privacy is a concern
  include_captures: false
  
  # File path where report will be written
  # If relative path, saved to current working directory
  # Supported: any valid file path
  output_file: "ble_report.json"
  
  # Include remediation recommendations in report (true/false)
  # Adds "Recommendations" section with prioritized actions
  include_recommendations: true
  
  # Include detailed technical analysis in report (true/false)
  # Adds verbose explanations of findings
  include_analysis: true
  
  # Timestamp format in reports
  # Options: "iso8601", "timestamp", "human"
  timestamp_format: "iso8601"

# Scope and authorization settings
# These settings are CRITICAL for legal and ethical testing
scope:
  # List of authorized device MAC addresses that may be tested
  # Use this for explicit whitelist of specific devices
  # Examples:
  #   - "AA:BB:CC:DD:EE:FF"
  #   - "11:22:33:44:55:66"
  # If any addresses are specified, ONLY these devices will be tested
  authorized_addresses: []
  
  # List of authorized device name patterns
  # Uses same wildcard rules as target.name_pattern
  # Examples:
  #   - "TestDevice*"
  #   - "Lab-*"
  #   - "Dev*"
  # Devices must match both authorized_addresses AND authorized_names
  authorized_names: []
  
  # List of authorized MAC address ranges (CIDR notation)
  # Allows testing entire ranges of devices
  # Examples:
  #   - "AA:BB:CC:00:00:00/AA:BB:CC:FF:FF:FF"  # All devices from vendor AA:BB:CC
  #   - "11:22:33:44:00:00/11:22:33:44:FF:FF"  # Range of 65536 devices
  authorized_ranges: []
  
  # Require explicit operator approval before testing (true/false)
  # When enabled, prompts for user confirmation before each attack
  require_approval: false
  
  # Geographic restriction (optional)
  # Only test devices in specified physical location
  # Helps prevent accidental testing of unintended devices
  location: null

# Advanced testing parameters
advanced:
  # Connection persistence between operations (true/false)
  # Keep connection open for multiple attacks on same device
  # Saves time but may affect device state
  persistent_connection: false
  
  # Parallel device processing (true/false)
  # Test multiple devices simultaneously
  # May increase load on adapter and reduce accuracy
  parallel_processing: false
  
  # Number of parallel workers if parallel_processing enabled
  parallel_workers: 2
  
  # Random jitter added to timing values (percentage)
  # Helps avoid detection/blocking by simulating natural user behavior
  timing_jitter: 0
  
  # Enable platform-specific optimizations (true/false)
  platform_optimizations: true

# Examples by attack type:
# 
# SCAN EXAMPLE:
# attack:
#   type: "scan"
#   timeout: 20
# scope:
#   authorized_names:
#     - "TestDevice*"
#
# PAIRING EXAMPLE:
# attack:
#   type: "pairing"
#   timeout: 20
#   max_retries: 3
# target:
#   address: "AA:BB:CC:DD:EE:FF"
# scope:
#   authorized_addresses:
#     - "AA:BB:CC:DD:EE:FF"
#
# FUZZING EXAMPLE:
# attack:
#   type: "fuzzing"
#   timeout: 120
#   intensity: "medium"
# target:
#   address: "AA:BB:CC:DD:EE:FF"
#   characteristics:
#     - "2A37"
#     - "2A18"
# scope:
#   authorized_addresses:
#     - "AA:BB:CC:DD:EE:FF"
#
# MITM EXAMPLE:
# attack:
#   type: "mitm"
#   timeout: 60
# target:
#   address: "AA:BB:CC:DD:EE:FF"
#   service_uuid: "180D"
# scope:
#   authorized_addresses:
#     - "AA:BB:CC:DD:EE:FF"
#
# REPLAY EXAMPLE:
# attack:
#   type: "replay"
#   timeout: 30
# target:
#   address: "AA:BB:CC:DD:EE:FF"
# scope:
#   authorized_addresses:
#     - "AA:BB:CC:DD:EE:FF"

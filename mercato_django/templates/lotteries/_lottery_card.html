{% load static %}

<div class="card lottery-card h-100 shadow-sm">
    <div class="lottery-card-image">
        <a href="{{ lottery.get_absolute_url }}" class="d-block text-decoration-none">
            {% if lottery.main_image_data_uri %}
                <img src="{{ lottery.main_image_data_uri }}" class="card-img-top" alt="{{ lottery.title }}">
            {% else %}
                <img src="{% static 'img/lottery-placeholder.svg' %}" class="card-img-top" alt="{{ lottery.title }}">
            {% endif %}
            {% if featured %}
                <span class="lottery-featured-badge">Featured</span>
            {% endif %}
        </a>
    </div>

    <div class="card-body d-flex flex-column">
        <h5 class="card-title mb-2">
            <a href="{{ lottery.get_absolute_url }}" class="text-decoration-none text-dark">{{ lottery.title }}</a>
        </h5>

        <p class="card-text text-muted mb-3">{{ lottery.description|truncatechars:110 }}</p>

        <div class="d-flex justify-content-between align-items-end gap-3 mt-auto">
            <div>
                <div class="small text-muted">Prezzo biglietto</div>
                <div class="fw-bold">â‚¬{{ lottery.ticket_price }}</div>
            </div>
            <div class="text-end">
                <div class="small text-muted">Rimanenti</div>
                <div class="fw-semibold">{{ lottery.tickets_remaining }}</div>
            </div>
        </div>

        <div class="progress mt-3" style="height: 8px;">
            <div class="progress-bar" role="progressbar" style="width: {{ lottery.progress_percent }}%" aria-valuenow="{{ lottery.progress_percent }}" aria-valuemin="0" aria-valuemax="100"></div>
        </div>

        <div class="d-flex justify-content-between mt-2 small text-muted">
            <span>{{ lottery.tickets_sold }}/{{ lottery.items_count }} venduti</span>
            <span>
                {% if lottery.expiration_date %}
                    Scade {{ lottery.expiration_date|date:"d/m/Y" }}
                {% else %}
                    Nessuna scadenza
                {% endif %}
            </span>
        </div>

        <div class="d-grid mt-3">
            <a href="{{ lottery.get_absolute_url }}" class="btn btn-primary">
                <i class="fas fa-eye me-2"></i>Vedi Dettagli
            </a>
        </div>
    </div>
</div>
